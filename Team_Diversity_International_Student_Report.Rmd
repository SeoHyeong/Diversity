---
title: "International Student Report"
author: "Team Diversity(SeoHyeong Jeong, Jolina Yao, Katarina Palermo, 
Jessica Chen, and QiMing Yeow)"
output: 
  ioslides_presentation:
    widescreen: true
    smaller: true
    fig_width: 4.5
    fig_height: 3
    fig_caption: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(DataComputing)
library(dplyr)
library(tidyr)
library(ggplot2)
```

----------------
**Questions**  
  
1. How will president, senate and house affect international students?    
2. Is there relationship between proportion of international students and college revenue?    
3. How will international students from the seven countries in the immigration executive order be affected under Trump administration? 
```{r cars, echo = FALSE}
data_clean <- read.csv(file="/Users/seohyeongjeong/Desktop/Diversity-master/Ming/data_clean.csv", header=TRUE, sep=",")
visa <- read.csv(file="/Users/seohyeongjeong/Desktop/visa/visa_party_enrollment.csv", header=TRUE, sep=",")
visa <- visa %>% 
  mutate(IS=ifelse(grepl("Iran|Iraq|Syria|Sudan|Libya|Yemen|Somalia", Country), "Yes", "No")) %>%
  transform(F.1 = as.numeric(F.1),
            J.1 = as.numeric(J.1),
            M.1 = as.numeric(M.1),
            Total.Visas = as.numeric(Total.Visas))
```

**Datasets**

1. Delta Cost Project Database  
Time Period: from 1987 to 2013  
Variables: Academic year, total enrollment, government funding, international students  
2. Visa   
Time Period: from 1997 to 2016  
Variables: F1, J1, M1, total visa, country, year  
3. Congress Data  
Time Period: from 1855 to 2015  
Variables: year, chamber, party status, seats  
4. Presidential Party (Web-Scrape)  
Time Period: from 1841 to 2017  
Variables: party, year


## Methods and Results
- UNIX, Web-Scrape, Data Wrangling
- Data Visualization
- Regression Analysis  
 
```{r pressure, echo=FALSE, message=FALSE, error=FALSE}
college_revenue <- data_clean %>%
  ggplot(aes(x = Academic_Year, y = Income_per_GDP, color = Party)) +
  geom_line(aes(color=Party, group=1), size = 1.5) +
  labs(title = "College Revenue (1987 - 2013)",
       x = "Academic Year",
       y = "College Revenue (% of GDP)") + 
  scale_color_manual(values=c(Democrat="#3366FF", Republican="#FF6633")) +
  theme(panel.grid.minor = element_blank(),
        panel.grid.major = element_line(size = 0.5, color = "Grey"),
        panel.grid.major.x = element_blank(),
        panel.background = element_blank(),
        plot.title = element_text(size = 15, face = "bold", hjust = 0.5),
        axis.title = element_text(size = 8, face = "italic")) +
  annotate("rect", xmin=1990, xmax=1991, ymin=-Inf, ymax=Inf, alpha=0.3) +
  annotate("rect", xmin=2000.5, xmax=2001.5, ymin=-Inf, ymax=Inf, alpha=0.3) +
  annotate("rect", xmin=2008, xmax=2010, ymin=-Inf, ymax=Inf, alpha=0.3)

college_revenue

int_student <- data_clean %>%
  filter(Academic_Year != 1988, Academic_Year != 1990) %>%
  ggplot(aes(x = Academic_Year, y = Prop_Intl_Student, color = Party)) +
  geom_line(aes(color=Party, group=1), size = 1.5) +
  labs(title = "International Student (1987 - 2013)",
       x = "Academic Year",
       y = "International Student (% of total enrollment)") + 
  scale_color_manual(values=c(Democrat="#3366FF", Republican="#FF6633")) +
  theme(panel.grid.minor = element_blank(),
        panel.grid.major = element_line(size = 0.5, color = "Grey"),
        panel.grid.major.x = element_blank(),
        panel.background = element_blank(),
        plot.title = element_text(size = 15, face = "bold", hjust = 0.5),
        axis.title = element_text(size = 8, face = "italic")) +
  annotate("rect", xmin=1990, xmax=1991, ymin=-Inf, ymax=Inf, alpha=0.3) +
  annotate("rect", xmin=2000.5, xmax=2001.5, ymin=-Inf, ymax=Inf, alpha=0.3) +
  annotate("rect", xmin=2008, xmax=2010, ymin=-Inf, ymax=Inf, alpha=0.3)

int_student
```

They both have similar trends  
Notably the sharp increase in 1999

## Regression Analysis
1. `rpart(Prop_Intl_Student ~ Party + House + Senate, data_clean)`  
Evaluating the model using current political parties, the model predicts that the proportion of international student is 3.234834%.

2. `lm(Income_per_GDP ~ Prop_Intl_Student + Government_funding_per_GDP, data_clean)`  
The model predicts college revenue per GDP is 1.160418%.

3. `lm(avgProp ~ president + Year, data=visa_prop)`  
The model predicts that in 2020 the number of international students from the seven countries in the immigration executive order is 0.004799307% of total enrollment.
```{r, echo=FALSE, message=FALSE, error=FALSE, warning=FALSE}
p3 <- data_clean %>%
  ggplot(aes(x = Prop_Intl_Student, y = Income_per_GDP)) +
  geom_point() +
  geom_smooth( method = "loess", se = FALSE, col = "red") +
  scale_x_continuous(limits = c(2.5,3.75)) + 
  labs(title = "College Revenue vs Proportion of International Student",
    x = "Proportion of International Student (%)",
    y = "College Revenue per GDP (%)") +
    theme(panel.grid.minor = element_blank(),
        panel.grid.major = element_line(size = 0.5, color = "Grey"),
        panel.grid.major.x = element_blank(),
        panel.background = element_blank(),
        plot.title = element_text(size = 10, face = "bold", hjust = 0.5),
        axis.title = element_text(size = 8, face = "italic"))
p3

point <- visa %>% 
  filter(IS=="Yes") %>%
  mutate(prop=((F.1+J.1+M.1)*100/Total_Enrollment)) %>%
  ggplot(aes(x=Year, y=prop)) +
  geom_point(aes(color=president)) +
  geom_smooth(method="loess", se = FALSE, col="red") +
  labs(title = "Average International Student Visa in Islamic States",
       x = "Academic Year",
       y = "F1, J1, M1 Visa Admission(% of total enrollment)") + 
  scale_color_manual(values=c(Democrat="#3366FF", Republican="#FF6633")) +
  theme(panel.grid.minor = element_blank(),
        panel.grid.major = element_line(size = 0.5, color = "Grey"),
        panel.grid.major.x = element_blank(),
        panel.background = element_blank(),
        plot.title = element_text(size = 10, face = "bold", hjust = 0.5),
        axis.title = element_text(size = 8, face = "italic")) +
  annotate("rect", xmin=2000.5, xmax=2001.5, ymin=-Inf, ymax=Inf, alpha=0.3) +
  annotate("rect", xmin=2008, xmax=2010, ymin=-Inf, ymax=Inf, alpha=0.3)


point
```
